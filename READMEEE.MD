一、系统目标概述

面向城市设计与城市规划方向的研究者或博士生。
输入主题和关键词，系统从多个学术源批量检索文献，去重并存入本地数据库。
调用 LLM 自动生成：
综述大纲
各章节详细综述内容
结构化分析信息（研究主题、方法、数据来源、结论、研究空白等）
前端提供：
关键词检索与抓取任务管理
本地文献库筛选浏览
一键生成综述（可编辑）
文本导出（Markdown 或其他格式）
二、总体架构设计（简要）

后端层
技术栈：Python + FastAPI
主要模块：
爬虫模块：封装 Arxiv、Scholar、Scopus 等数据源的检索接口；统一抽象为中间文献结构，支持分页和限流。
数据层：SQLite 或 PostgreSQL，定义 Paper、Review、CrawlJob、StagingPaper 等数据表。
业务服务层：
文献检索与去重逻辑
爬取任务调度与状态管理
LLM 调用服务（综述生成、摘要、主题聚类）
导出服务（把综述转为 Markdown 或 HTML）
API 层：提供文献检索、任务管理、综述生成、导出下载等 HTTP 接口。
前端层
技术栈：React + TypeScript + Vite
主要页面：
综述助手页：输入关键词 + 数据源选择，展示抓取状态和 LLM 生成的综述。
文献库页：本地文献列表、筛选、排序、查看详情。
抓取任务页：查看历史抓取任务、状态、错误信息。
设置页：配置 LLM 接口、数据源开关等。
数据流（简要）
用户在前端输入城市设计主题关键词，选择数据源，创建抓取任务。
后端调用各数据源爬虫，拉取原始文献数据，中间标准化后去重，写入暂存库或正式库。
用户选择一批文献或按条件检索出的结果，触发综述生成。
后端调用 LLM：
先对文献进行分类与主题抽取
生成章节大纲
分章节写详细综述
汇总为整体综述
前端展示结果，并支持导出下载。
三、详细开发 Todo List（按阶段）

下面的 Todo 按执行顺序排列，每一条尽量是独立、可执行的小任务。

阶段 0：基础环境与项目骨架

初始化后端项目（虚拟环境、依赖管理、FastAPI 应用结构）。
初始化前端项目（使用 Vite 创建 React TypeScript 模板）。
在后端实现基础健康检查接口，用于前后端联通测试。
在前端实现一个简单页面，测试能通过浏览器访问后端健康检查接口。
阶段 1：数据模型与数据库
5. 设计 Paper 实体字段：标题、作者、摘要、发表时间、期刊或会议名称、关键词、领域标签等。
6. 设计 Review 实体字段：关联主题、关联文献列表、生成的大纲与正文、分析统计字段。
7. 设计 CrawlJob 实体字段：关键词、数据源列表、状态、统计信息（抓取数量、失败数量）。
8. 设计 StagingPaper 暂存实体（可选）：用于多源合并与人工筛选，字段基本沿用 Paper，增加来源和批次信息。
9. 使用 ORM（如 SQLAlchemy）创建表结构和数据库初始化脚本。

阶段 2：多源爬虫与批量检索
10. 抽象一个统一的“数据源客户端”接口，约定输入（关键词、年份范围、分页参数）和输出结构（标准化文献信息）。
11. 实现 Arxiv 数据源客户端，实现基本关键词检索功能和结果解析。
12. 实现 Scholar 或 SerpAPI 学术搜索客户端（如果使用第三方 API，加入 API Key 配置与限流处理）。
13. 预留 Scopus 或 Web of Science 等高质量数据源客户端占位实现，后续逐步补全。
14. 实现一个多源调度器：
- 接收统一检索请求
- 并发或顺序调用各数据源
- 聚合结果并返回统一列表。
15. 在后端提供“多源关键词检索” API，支持指定数据源数组与年份范围。

阶段 3：去重、入库与抓取任务系统
16. 设计文献去重规则（优先使用 DOI，其次用标准化标题 + 年份）。
17. 实现去重逻辑：对于来自不同源的相同论文合并为一条记录。
18. 实现抓取任务创建接口：接收关键词、数据源列表、年份范围，插入一条 CrawlJob 记录。
19. 实现抓取任务执行逻辑：
- 根据 CrawlJob 配置调用多源调度器
- 写入 StagingPaper 或 Paper 表
- 更新任务状态和统计字段。
20. 实现抓取任务列表和详情 API：可以按状态筛选，查看日志与统计。
21. 如需审稿流程：增加从 StagingPaper 提升为正式 Paper 的批量操作服务与 API。

阶段 4：文献检索与本地文献库管理
22. 实现 Paper 检索接口：支持按关键词、年份范围、来源、是否有全文等条件过滤。
23. 为检索结果增加分页和排序（按时间、引用数等）。
24. 实现 Paper 详情接口：返回单篇文献的完整信息。
25. 预留标签或主题字段，用于后续主题聚类和分组综述。

阶段 5：LLM 综述生成管线
26. 封装 LLM 客户端，支持配置不同模型和 API Key。
27. 实现“单篇文献摘要”功能：给定文献信息，生成简短摘要和关键信息提要。
28. 实现“多文献主题抽取与聚类”逻辑：根据若干文献的摘要，生成若干主题标签和聚类结果（可先在 LLM 提示词里完成）。
29. 实现“综述大纲生成”逻辑：根据主题和文献信息，生成章节结构（如研究背景、方法对比、案例研究、讨论与展望等）。
30. 实现“分章节内容生成”逻辑：对每个章节按相关文献批量生成段落级文字。
31. 实现“总览总结”逻辑：在章节基础上生成结论、研究空白、未来研究方向等。
32. 将大纲、章节内容、总结和结构化分析统计字段统一写入 Review 记录，持久化存储。

阶段 6：前端界面开发（核心体验）
33. 综述助手页：
- 实现输入关键词、选择数据源和年份范围的表单。
- 调用后端创建抓取任务的接口。
- 展示抓取任务的实时状态（排队中、运行中、完成、失败）。
- 在抓取完成后提供“生成综述”按钮，调用 LLM 综述接口。
- 展示生成的大纲与正文，并允许用户简单编辑。
34. 文献库页：
- 列表显示本地 Paper 数据（标题、作者、年份、期刊、标签）。
- 提供条件筛选和分页控件。
- 支持点击查看文献详情弹窗或详情侧栏。
35. 抓取任务页：
- 显示历史 CrawlJob 列表（关键词、数据源、创建时间、状态、文献数量）。
- 支持按状态过滤，并查看任务详情和错误信息。
36. 设置页：
- 配置 LLM API Key 和模型名称。
- 配置各数据源开关和相关 API 设置。

阶段 7：导出与下载功能
37. 在后端实现将 Review 转为 Markdown 文本的函数。
38. 可选：实现 Markdown 转 HTML，便于浏览器预览。
39. 在前端的综述助手页为每个 Review 提供“导出为 Markdown 文件”的按钮。
40. 可选：集成第三方工具把 HTML 转为 PDF，在后端生成文件并返回下载链接。

阶段 8：城市设计领域特化与增强
41. 在提示词中注入城市设计领域约束（如可要求涵盖公共空间、形态学、街道网络、社会公平等方面）。
42. 设计一套领域关键主题列表，用于指导 LLM 在综述中自动覆盖不同子主题。
43. 为 Paper 增加领域标签字段，引入简单的规则或 LLM 标注逻辑，为城市设计主题自动贴标签。
44. 在前端综述结果页显示这些领域标签，并允许用户手动微调。

阶段 9：质量控制、测试与部署
45. 编写后端单元测试和集成测试：覆盖文献去重、抓取任务、LLM 调用错误处理等关键路径。
46. 编写前端端到端测试或手动测试脚本，验证一条完整流程：输入主题 → 抓取文献 → 检索浏览 → 生成综述 → 导出。
47. 设计部署方案：例如使用 Uvicorn 或 Gunicorn 运行 FastAPI，Nginx 提供静态前端资源和反向代理。
48. 编写部署文档和使用说明：包括环境变量配置、启动命令、常见错误排查要点。

